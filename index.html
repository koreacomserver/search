<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Element Animation 검색</title>

    <!-- 1. Google 커스텀 검색 스크립트 (요청하신 코드) -->
    <!-- 이 스크립트는 검색 결과('gcse-searchresults-only')와 검색창('data-searchresults-gname')을 연결합니다. -->
    <script async src="https://cse.google.com/cse.js?cx=a766441461ad64cfd"></script>

    <style>
        /* 기본 스타일 및 전체 레이아웃 */
        body {
            background-color: #202124; /* 구글 다크 모드 배경색 */
            font-family: Arial, sans-serif;
            color: #e8eaed;
            display: flex;
            /* 검색 결과가 아래에 표시되므로 align-items: center 제거 */
            justify-content: center;
            flex-direction: column; /* 컨텐츠를 세로로 정렬 */
            align-items: center; /* 수평 중앙 정렬 */
            min-height: 100vh; /* 화면 전체 높이 */
            margin: 0;
            padding-top: 50px; /* 상단 여백 */
            position: relative; /* 언어 설정 배치를 위해 relative 설정 */
        }

        /* 언어 설정 컨테이너 */
        .language-container {
            position: absolute;
            top: 20px;
            right: 30px;
            display: flex;
            gap: 15px;
            font-size: 13px;
        }

        /* 언어 링크 스타일 */
        .language-container a {
            color: #bdc1c6; /* 약간 더 밝은 회색 */
            text-decoration: none;
        }

        .language-container a:hover {
            text-decoration: underline;
            color: #e8eaed;
        }
        
        /* 활성 언어 스타일 */
        .language-container a.active {
            color: #8ab4f8; /* 파란색으로 활성 표시 */
            font-weight: bold;
            text-decoration: none;
        }

        /* 모든 요소를 감싸는 중앙 정렬 컨테이너 */
        .main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            /* padding-top: 50px; 제거 (body로 이동) */
        }

        /* 로고 이미지 */
        .logo {
            /* 이미지 원본 비율(473x98)을 고려하여 너비 설정 */
            width: 400px;  
            max-width: 90%; /* 모바일 대응 */
            margin-bottom: 30px;
        }

        /* 검색창 컨테이너 */
        .search-bar {
            display: flex;
            align-items: center;
            border: 1px solid #5f6368; /* 테두리 */
            border-radius: 24px;       /* 둥근 모서리 */
            width: 580px;
            max-width: 90%; /* 모바일 대응 */
            height: 44px;
            padding: 0 16px;
            margin-bottom: 30px;
            box-sizing: border-box; /* 패딩이 너비에 포함되도록 설정 */
        }

        /* 검색창 호버 효과 */
        .search-bar:hover {
            background-color: #303134;
            border-color: #303134;
        }

        /* --- 7. 음성 검색 활성 스타일 (추가) --- */
        /* 음성 인식이 활성화되었을 때 마이크 아이콘 스타일 */
        .search-bar.listening .mic-icon {
            fill: #f88a8a; /* 빨간색으로 변경 */
            animation: pulse 1.5s infinite; /* 깜빡이는 효과 */
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        /* --- 스타일 수정 끝 --- */

        /* 검색창 내부 아이콘 공통 스타일 */
        .search-bar svg {
            fill: #9aa0a6; /* 기본 아이콘 색상 */
            height: 20px;
            width: 20px;
            flex-shrink: 0; /* 아이콘이 찌그러지지 않도록 설정 */
        }

        /* 검색창 내부 텍스트 입력 필드 */
        .search-bar input[type="text"] {
            flex-grow: 1; /* 남은 공간 모두 차지 */
            background-color: transparent;
            border: none;
            outline: none;
            color: #e8eaed; /* 입력 텍스트 색상 */
            font-size: 16px;
            margin-left: 15px;
            width: 100%; /* 너비 100%로 유연하게 */
        }
        
        /* placeholder 텍스트 스타일 */
        .search-bar input[type="text"]::placeholder {
            color: #9aa0a6; /* placeholder 색상 */
            opacity: 1; /* Firefox에서 기본 투명도 제거 */
        }

        /* 마이크, 카메라 아이콘 스타일 */
        .search-bar .icon-right {
            fill: #8ab4f8; /* 이미지 속 파란색 아이콘 */
            height: 24px;
            width: 24px;
            margin-left: 15px;
            cursor: pointer;
        }
        
        /* 버튼들을 감싸는 컨테이너 */
        .button-container {
            display: flex;
            gap: 12px; /* 버튼 사이 간격 */
        }

        /* 버튼 기본 스타일 */
        .button-container button {
            background-color: #303134;
            border: 1px solid #303134;
            border-radius: 4px;
            color: #e8eaed;
            font-size: 14px;
            padding: 10px 16px;
            cursor: pointer;
            font-family: Arial, sans-serif;
        }

        /* 버튼 호버 효과 */
        .button-container button:hover {
            border-color: #5f6368;
        }

        /* --- 2. 검색 결과 컨테이너 스타일 (추가) --- */
        #search-results-container {
            width: 600px;
            max-width: 90%;
            margin-top: 30px;
            background-color: transparent; /* 배경을 투명하게 */
        }

        /* Google CSE 결과 스타일 오버라이드 (다크 모드 적용) */
        .gsc-control-cse {
            background-color: transparent !important;
            border: none !important;
            padding: 0 !important;
        }
        .gsc-tabsArea, .gsc-above-wrapper-area {
            border-bottom: 1px solid #5f6368 !important;
        }
        .gsc-tabHeader {
            color: #9aa0a6 !important;
        }
        .gsc-tabHeader.gsc-tab-active {
            color: #8ab4f8 !important;
            border-bottom: 2px solid #8ab4f8 !important;
        }
        .gs-webResult.gs-result, .gsc-results .gsc-imageResult {
            background-color: #2a2b2e !important; /* 결과 아이템 배경 */
            border: 1px solid #5f6368 !important; /* 결과 아이템 테두리 */
            border-radius: 8px;
            padding: 16px !important;
            margin-bottom: 12px !important;
        }
        .gs-webResult .gs-title, .gs-webResult .gs-title *,
        .gsc-imageResult .gs-title, .gsc-imageResult .gs-title * {
            color: #8ab4f8 !important; /* 링크 색상 */
            text-decoration: none !important;
        }
        .gs-webResult .gs-title:hover, .gs-webResult .gs-title:hover * {
            text-decoration: underline !important;
        }
        .gs-webResult .gs-snippet, .gs-webResult .gs-visibleUrl {
            color: #bdc1c6 !important; /* 스니펫, URL 색상 */
        }
        .gsc-cursor-page {
            color: #9aa0a6 !important;
        }
        .gsc-cursor-current-page {
            color: #e8eaed !important;
        }
        .gsc-results .gsc-cursor-box {
            border-top: 1px solid #5f6368 !important;
        }
        /* --- 스타일 수정 끝 --- */

        /* --- 8. 이미지 검색 모달 스타일 (추가) --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            /* 기본적으로 숨김 */
            display: none; 
        }

        .modal-content {
            background-color: #303134;
            padding: 24px;
            border-radius: 8px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 28px;
            color: #9aa0a6;
            cursor: pointer;
            line-height: 1;
        }
        .modal-close:hover {
            color: #e8eaed;
        }

        .modal-content h3 {
            margin-top: 0;
            color: #e8eaed;
        }
        .modal-content p {
            color: #bdc1c6;
            font-size: 14px;
        }

        .modal-input-container {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-input-container input[type="text"] {
            flex-grow: 1;
            padding: 10px 14px;
            background-color: #202124;
            border: 1px solid #5f6368;
            border-radius: 4px;
            color: #e8eaed;
            font-size: 14px;
            outline: none;
        }
        .modal-input-container input[type="text"]:focus {
            border-color: #8ab4f8;
        }

        .modal-input-container button {
            background-color: #8ab4f8;
            color: #202124;
            border: none;
            border-radius: 4px;
            padding: 0 16px;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
        }
        .modal-input-container button:hover {
            opacity: 0.9;
        }
        /* --- 스타일 수정 끝 --- */

    </style>
</head>
<body>

    <!-- 1. 언어 설정 -->
    <div class="language-container">
        <a href="#" class="lang-link" data-lang="en">English</a>
        <a href="#" class="lang-link" data-lang="es">Español</a>
        <a href="#" class="lang-link" data-lang="ko">한국어</a>
    </div>

    <div class="main-container">
        
        <!-- 2. 로고 이미지 -->
        <img src="https://i.namu.wiki/i/mtKZkYjXOkOSucsGg-sU8mveeLfN8b0ixNCdibuiCKx5ga_bkh_dW975wxxnEyArrlGh2No7AuLX3W_PX-8gNg.webp" alt="Element Animation Logo" class="logo">

        <!-- 3. 검색창 (수정: input 및 mic-icon 복원) -->
        <div class="search-bar">
            <!-- 검색 아이콘 (SVG) -->
            <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
            </svg>
            
            <!-- 텍스트 입력 필드 (id="search-input" 추가) -->
            <input type="text" placeholder="검색어를 입력하세요" id="search-input" data-searchresults-gname="my-search">
            
            <!-- 마이크 아이콘 (SVG) - (id, class, title 추가) -->
            <svg id="mic-icon" class="icon-right mic-icon" focusable="false" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" title="음성 검색">
                <path d="m12 15c1.66 0 3-1.34 3-3v-6c0-1.66-1.34-3-3-3s-3 1.34-3 3v6c0 1.66 1.34 3 3 3z"></path><path d="m11 18.92h2v3.08h-2z"></path><path d="m7.05 16.87c-1.27-1.33-2.05-3.05-2.05-4.87h2c0 1.45 0.56 2.82 1.57 3.83z"></path><path d="m12 16.93a4.97 4.97 0 0 1 -3.54-1.46l-1.41 1.41a6.98 6.98 0 0 0 9.9-0.12l-1.41-1.41a4.97 4.97 0 0 1 -3.54 1.58z"></path>
            </svg>

            <!-- 카메라 아이콘 (SVG) - (id, title 수정) -->
            <svg id="camera-icon" class="icon-right" focusable="false" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" title="이미지로 검색">
                <path d="M13.17 6H11v2h2.17l5.42 5.42L19 13V6h-5.83zM11 8v2h2v-2H11z" opacity=".3"></path><path d="M11 14H9v-2H7v2H5v2h2v2h2v-2h2v-2zm8-1.59L15.59 9H13v2h2.17l3.42 3.42.41-.41zM11 10H9V8h2v2zm10-5H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H3V7h18v14z"></path>
            </svg>
        </div>

        <!-- 4. 버튼 컨테이너 -->
        <div class="button-container">
            <button id="search-btn">Search</button>
            <button>I'm Feeling Lucky</button>
        </div>

    </div>

    <!-- 
      5. 검색 결과가 표시될 컨테이너 (추가)
      'class="gcse-searchresults-only"'는 Google 스크립트가 인식하는 클래스입니다.
      'data-gname="my-search"'를 통해 위의 검색창('data-searchresults-gname')과 연결됩니다.
    -->
    <div id="search-results-container" class="gcse-searchresults-only" data-gname="my-search"></div>


    <!-- 6. 이미지 검색 모달 (추가) -->
    <div id="image-search-modal" class="modal-overlay">
        <div class="modal-content">
            <span class="modal-close" id="modal-close-btn">&times;</span>
            <h3 id="modal-title">이미지로 검색</h3>
            <p id="modal-desc">검색할 이미지 URL을 붙여넣으세요.</p>
            <div class="modal-input-container">
                <input type="text" id="image-url-input" placeholder="https://example.com/image.png">
                <button id="image-search-btn">검색</button>
            </div>
        </div>
    </div>


    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 번역 텍스트 객체
            const translations = {
                'en': {
                    placeholder: 'Enter search term',
                    search: 'Search',
                    lucky: "I'm Feeling Lucky"
                },
                'es': {
                    placeholder: 'Introducir término de búsqueda',
                    search: 'Buscar',
                    lucky: 'Me siento con suerte'
                },
                'ko': {
                    placeholder: '검색어를 입력하세요',
                    search: 'Search', // 구글은 'Google 검색'이지만, 기존 디자인 유지를 위해 'Search' 사용
                    lucky: "I'm Feeling Lucky"
                }
            };

            // --- 8. 모달 번역 텍스트 추가 ---
            translations['en'].modalTitle = 'Search by image';
            translations['en'].modalDesc = 'Paste an image URL to search';
            translations['en'].modalBtn = 'Search';
            translations['es'].modalTitle = 'Buscar por imagen';
            translations['es'].modalDesc = 'Pegar una URL de imagen para buscar';
            translations['es'].modalBtn = 'Buscar';
            translations['ko'].modalTitle = '이미지로 검색';
            translations['ko'].modalDesc = '검색할 이미지 URL을 붙여넣으세요.';
            translations['ko'].modalBtn = '검색';
            // --- 번역 텍스트 추가 끝 ---


            // DOM 요소 선택
            const searchInput = document.getElementById('search-input');
            const searchBtn = document.getElementById('search-btn');
            const luckyBtn = document.querySelector('.button-container button:last-child');
            const langLinks = document.querySelectorAll('.lang-link');
            const micIcon = document.getElementById('mic-icon'); // 마이크 아이콘 DOM 선택
            const searchBar = document.querySelector('.search-bar'); // 검색창 DOM 선택

            // --- 8. 모달 DOM 요소 선택 (추가) ---
            const cameraIcon = document.getElementById('camera-icon');
            const imageModal = document.getElementById('image-search-modal');
            const closeModalBtn = document.getElementById('modal-close-btn');
            const imageUrlInput = document.getElementById('image-url-input');
            const imageSearchModalBtn = document.getElementById('image-search-btn');
            const modalTitle = document.getElementById('modal-title');
            const modalDesc = document.getElementById('modal-desc');
            // --- 모달 DOM 선택 끝 ---

            // 언어 설정 함수 (모달 텍스트 번역 추가)
            function setLanguage(lang) {
                // 'en-US', 'ko-KR' 등에서 'en', 'ko'만 추출
                const shortLang = lang.split('-')[0];
                
                // 지원되는 언어인지 확인, 아니면 영어(en)로 기본 설정
                const selectedLang = translations[shortLang] ? shortLang : 'en';
                
                const texts = translations[selectedLang];

                // 텍스트 적용
                // (오류 방지) searchInput이 존재하는지 확인 후 placeholder 설정
                if (searchInput) {
                    searchInput.placeholder = texts.placeholder;
                }
                searchBtn.textContent = texts.search;
                luckyBtn.textContent = texts.lucky;

                // --- 8. 모달 텍스트 적용 (추가) ---
                modalTitle.textContent = texts.modalTitle;
                modalDesc.textContent = texts.modalDesc;
                imageSearchModalBtn.textContent = texts.modalBtn;
                // --- 모달 텍스트 적용 끝 ---
                
                // HTML lang 속성 변경 (웹 접근성 및 음성인식 언어 설정용)
                document.documentElement.lang = selectedLang;

                // 활성 언어 링크 스타일 업데이트
                langLinks.forEach(link => {
                    if (link.dataset.lang === selectedLang) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }

            // 1. 브라우저 기본 언어로 초기 설정
            setLanguage(navigator.language);

            // 2. 언어 링크에 클릭 이벤트 추가 (이 부분이 새로 추가되었습니다)
            langLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault(); // 링크의 기본 동작(페이지 이동) 방지
                    const selectedLang = e.target.dataset.lang; // 클릭된 링크의 data-lang 값 가져오기
                    setLanguage(selectedLang); // 해당 언어로 텍스트 변경
                });
            });

            // --- 3. Google 검색 실행 함수 (수정) ---
            function executeSearch(query) {
                // Google CSE 스크립트가 로드되었는지, 쿼리가 있는지 확인
                if (query && window.google && google.search.cse) {
                    // 'my-search'는 우리가 HTML의 data-gname에 지정한 이름입니다.
                    const element = google.search.cse.element.getElement('my-search');
                    if (element) {
                        element.execute(query); // 검색 실행
                    }
                }
            }

            // --- 4. Google 검색 버튼 클릭 이벤트 (수정) ---
            searchBtn.addEventListener('click', (e) => {
                e.preventDefault(); // 버튼 기본 동작 방지
                const query = searchInput.value.trim();
                executeSearch(query); // 검색 함수 호출
            });

            // --- 5. Enter 키 누름 이벤트 (수정) ---
            // (오류 방지) searchInput이 존재하는지 확인 후 이벤트 리스너 추가
            if (searchInput) {
                searchInput.addEventListener('keydown', (e) => {
                    // e.key === 'Enter' 는 엔터 키를 눌렀는지 확인합니다.
                    if (e.key === 'Enter') {
                        e.preventDefault(); // 엔터 키의 기본 동작(예: 줄바꿈) 방지
                        const query = searchInput.value.trim();
                        executeSearch(query); // 검색 함수 호출
                    }
                });
            }

            // --- 6. "I'm Feeling Lucky" 버튼 클릭 이벤트 (복원) ---
            luckyBtn.addEventListener('click', (e) => {
                e.preventDefault();
                const query = searchInput.value.trim();
                if (query) {
                    // Google의 'I'm Feeling Lucky' URL로 리디렉션
                    const url = `https://www.google.com/search?q=${encodeURIComponent(query)}&btnI`;
                    window.location.href = url;
                }
            });

            // --- 7. 음성 검색 기능 (기존) ---
            
            // 웹 음성 API 지원 확인 (Chrome은 webkit 접두사 필요)
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            let recognition;

            // (오류 방지) micIcon이 존재하는지 확인
            if (SpeechRecognition && micIcon) {
                recognition = new SpeechRecognition();
                
                // 음성 인식이 끝나면 호출됨
                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript; // 인식된 음성 텍스트
                    if (searchInput) {
                        searchInput.value = transcript; // 검색창에 텍스트 입력
                    }
                    executeSearch(transcript); // 즉시 검색 실행
                };

                // 음성 인식이 시작될 때
                recognition.onstart = () => {
                    searchBar.classList.add('listening'); // 'listening' 클래스 추가 (아이콘 스타일 변경)
                };

                // 음성 인식이 끝날 때 (오류가 나도 호출됨)
                recognition.onend = () => {
                    searchBar.classList.remove('listening'); // 'listening' 클래스 제거
                };

                // 오류 발생 시
                recognition.onerror = (event) => {
                    console.error("음성 인식 오류:", event.error);
                    searchBar.classList.remove('listening');
                };

                // 마이크 아이콘 클릭 이벤트
                micIcon.addEventListener('click', () => {
                    try {
                        // 현재 설정된 언어로 음성 인식 언어 설정
                        recognition.lang = document.documentElement.lang;
                        recognition.start(); // 음성 인식 시작
                    } catch (e) {
                        console.error("음성 인식 시작 오류:", e);
                        searchBar.classList.remove('listening');
                    }
                });

            } else {
                console.warn("이 브라우저는 음성 인식을 지원하지 않습니다.");
                // 지원하지 않는 경우 마이크 아이콘을 숨기거나 비활성화할 수 있습니다.
                if (micIcon) {
                    micIcon.style.display = 'none';
                }
            }
            
            // --- 8. 이미지 검색 모달 기능 (추가) ---

            // (오류 방지) cameraIcon이 존재하는지 확인
            if (cameraIcon) {
                // 카메라 아이콘 클릭: 모달 열기
                cameraIcon.addEventListener('click', () => {
                    imageModal.style.display = 'flex';
                    imageUrlInput.value = ''; // 입력창 비우기
                    imageUrlInput.focus();
                });
            }

            // 모달 닫기 버튼
            closeModalBtn.addEventListener('click', () => {
                imageModal.style.display = 'none';
            });

            // 모달 바깥쪽 클릭 시 닫기
            imageModal.addEventListener('click', (e) => {
                if (e.target === imageModal) {
                    imageModal.style.display = 'none';
                }
            });

            // 모달 내 '검색' 버튼 클릭: Google Lens로 리디렉션
            imageSearchModalBtn.addEventListener('click', () => {
                const imageUrl = imageUrlInput.value.trim();
                if (imageUrl) {
                    // Google Lens (역방향 이미지 검색) URL로 리디렉션
                    const url = `https://lens.google.com/uploadbyurl?url=${encodeURIComponent(imageUrl)}`;
                    window.location.href = url;
                    imageModal.style.display = 'none'; // 검색 후 모달 닫기
                }
            });

            // 모달 내 입력창에서 Enter 키
            imageUrlInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    imageSearchModalBtn.click(); // 검색 버튼 클릭 트리거
                }
            });
            // --- JS 수정 끝 ---
        });
    </script>

</body>
</html>

